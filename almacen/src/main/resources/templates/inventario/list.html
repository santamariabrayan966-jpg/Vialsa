<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Inventario</title>
    <link rel="stylesheet" th:href="@{/css/main.css}">
</head>
<body>
<header>
    <h1>Inventario</h1>
    <nav>
        <a th:href="@{/}">Inicio</a>
        <a th:href="@{/productos}">Productos</a>
        <a th:href="@{/pedidos}">Pedidos</a>
        <a th:href="@{/ventas}">Ventas</a>
        <form th:action="@{/logout}" method="post" style="display:inline; margin-left:1rem;">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <button type="submit">Cerrar sesión</button>
        </form>
    </nav>
</header>
<main>
    <p th:text="'Sesión iniciada como ' + ${#httpServletRequest.userPrincipal?.name}"></p>
    <section>
        <h2>Existencias actuales</h2>
        <table>
            <thead>
            <tr>
                <th>Producto</th>
                <th>Descripción</th>
                <th>Stock</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="producto : ${inventario}">
                <td th:text="${producto.nombre}"></td>
                <td th:text="${producto.descripcion}"></td>
                <td th:text="${producto.stock}"></td>
            </tr>
            </tbody>
        </table>
    </section>
    <section>
        <h2>Ajustar inventario manualmente</h2>
        <form th:action="@{/inventario/ajustar}" th:object="${ajusteForm}" method="post">
            <label for="productoId">Producto</label>
            <select id="productoId" th:field="*{productoId}">
                <option value="" disabled selected>Seleccione un producto</option>
                <option th:each="producto : ${inventario}" th:value="${producto.id}" th:text="${producto.nombre}"></option>
            </select>
            <span class="error" th:if="${#fields.hasErrors('productoId')}" th:errors="*{productoId}"></span>

            <label for="tipo">Tipo</label>
            <select id="tipo" th:field="*{tipo}">
                <option value="" disabled selected>Seleccione</option>
                <option th:each="tipo : ${movimientos}" th:value="${tipo}" th:text="${tipo}"></option>
            </select>
            <span class="error" th:if="${#fields.hasErrors('tipo')}" th:errors="*{tipo}"></span>

            <label for="cantidad">Cantidad</label>
            <input id="cantidad" type="number" min="1" th:field="*{cantidad}">
            <span class="error" th:if="${#fields.hasErrors('cantidad')}" th:errors="*{cantidad}"></span>

            <button type="submit">Registrar movimiento</button>
        </form>
    </section>
</main>
</body>
</html>
